test
public class BankServer {

    // Variabili per mantenere stato
    private static int balance = 0;
    private static List<String> history = new ArrayList<>();
    private static boolean initAllowed = true;

    public static void main(String[] args) {
        try (ServerSocket serverSocket = new ServerSocket(3000)) {
            System.out.println("Server in ascolto sulla porta 3000...");
            
            while (true) {
                try (Socket clientSocket = serverSocket.accept()) {
                    System.out.println("Connessione accettata: " + clientSocket.getInetAddress());
                    handleClient(clientSocket);
                } catch (IOException e) {
                    System.err.println("Errore nella connessione del client: " + e.getMessage());
                }
            }
        } catch (IOException e) {
            System.err.println("Errore nel creare il server: " + e.getMessage());
        }
    }

    private static void handleClient(Socket clientSocket) {
        try (BufferedReader in = new BufferedReader(new InputStreamReader(clientSocket.getInputStream()));
             PrintWriter out = new PrintWriter(clientSocket.getOutputStream(), true)) {

            // Handshake iniziale
            out.println("WELCOME BANK v1 BAL " + balance);

            String line;
            while ((line = in.readLine()) != null) {
                String[] parts = line.split(" ");
                String command = parts[0];

                switch (command) {
                    case "INIT":
                        handleInit(parts, out);
                        break;
                    case "BAL":
                        handleBalance(out);
                        break;
                    case "DEPOSIT":
                        handleDeposit(parts, out);
                        break;
                    case "WITHDRAW":
                        handleWithdraw(parts, out);
                        break;
                    case "HISTORY":
                        handleHistory(out);
                        break;
                    case "RESET":
                        handleReset(out);
                        break;
                    case "QUIT":
                        out.println("BYE");
                        return;
                    default:
                        out.println("ERR UNKNOWNCMD");
                        break;
                }
            }
        } catch (IOException e) {
            System.err.println("Errore di I/O: " + e.getMessage());
        }
    }

    private static void handleInit(String[] parts, PrintWriter out) {
        if (parts.length != 2) {
            out.println("ERR SYNTAX");
            return;
        }

        try {
            int initAmount = Integer.parseInt(parts[1]);

            if (initAmount < 0) {
                out.println("ERR SYNTAX");
                return;
            }

            if (!initAllowed) {
                out.println("ERR NOTALLOWED");
                return;
            }

            balance = initAmount;
            history.clear(); // Reset storico
            initAllowed = false;
            out.println("OK INIT BAL " + balance);

        } catch (NumberFormatException e) {
            out.println("ERR SYNTAX");
        }
    }

    private static void handleBalance(PrintWriter out) {
        out.println("INFO BAL " + balance);
    }

    private
